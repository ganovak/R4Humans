<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Multi-Plot Formatting</title>
        <style>

    html body {
        font-family: 'Crimson Text', sans-serif;
        background-color: #f5f5f5;
    }

    :root {
        --accent: #4A235A;
        --border-width:  0 ;
    }

</style>


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Crimson%20Text">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=VT323">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.0/css/all.css" integrity="sha384-Mmxa0mLqhmOeaE8vgOSbKacftZcsNYDjQzuCOm6D02luYSzBG8vpaOykv9lFQ51Y" crossorigin="anonymous">


<link rel="stylesheet" href="/css/main.css">




 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
    

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>


<script>
$(document).ready(function(){
    
  var input = $('#night-mode-toggle');
  var container = $('#bigbody');
  var stat = $('#button-status');
  
  container.toggleClass(localStorage.toggled);
  stat.bootstrapToggle(localStorage.button).change();
  
  input.on('click', function() {
      if (localStorage.toggled != "-nightmode" ) {
          container.toggleClass("-nightmode", true );
          localStorage.toggled = "-nightmode";
          localStorage.button = "on";
       } else {
          container.toggleClass("-nightmode", false );
          localStorage.toggled = "";
          localStorage.button = "off"
       }
  })
});
</script>
 <meta name="generator" content="Hugo 0.56.3" />
        
        

    
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#000000">
    <link rel="shortcut icon" href="/img/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="/img/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    
    
    <meta property="og:title" content="Multi-Plot Formatting">
    <meta property="og:type" content="article">
      
      <meta name="twitter:card" content="summary">
      <meta name="twitter:image" content="/" >
      
    <meta property="description" content="">
    <meta property="og:description" content="">
    
    <meta name="twitter:creator" content="">
    <meta name="twitter:site" content="">
    
    </head>

    
    
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <body id = "bigbody">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Multi-Plot Formatting</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Quick Tasks</a></li>
                            
                                <li><a href="/project/">Learning</a></li>
                            
                                <li><a href="/tags/">Topics</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:gabriellanovak00@gmail.com"><i class="far fa-envelope"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://ganovak.netlify.com/"><i class="fas fa-cloud"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/ganovak/"><i class="fab fa-github"></i></a></li>
                            
                            <li id="night-mode-toggle">
    <input type="checkbox" id = "button-status"
        data-toggle="toggle"
        data-width = "10"
        data-height = "1"
        data-on="<i class='far fa-moon fa-lg'></i>"
        data-off= "<i class='far fa-sun fa-lg'></i>"
        data-style="ios"
        data-onstyle = "default">
</li>
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div class="item">

    
    
    

    
    
      
    

    <h4><a href="/project/multiplotformatting/">Multi-Plot Formatting</a></h4>
    <h5>October 21, 2019 - 4 minutes</h5>
    <h5></h5>

    

        <a href="/categories/graphics">
        <kbd class="item-cat"> Graphics </kbd>
    </a>
    
    
    <a href="/tags/gridextra">
        <kbd class="item-tag"> gridExtra </kbd>
    </a>
    
    <a href="/tags/cowplot">
        <kbd class="item-tag"> cowplot </kbd>
    </a>
    
    <a href="/tags/ggpubr">
        <kbd class="item-tag"> ggpubr </kbd>
    </a>
    

</div>


    <br> <div class="text-justify">


<p>Adding one plot to a report is not hard. The difficulty comes when two or more plots are required to be arranged in some sort of grid (this includes just two graphs side by side). There are several options for how this is accomplished based on what specific arguments are needed.</p>
<div id="data-preparation" class="section level1">
<h1>Data Preparation</h1>
<p><strong>Example data used in demonstration available <a href="%22https://github.com/ganovak/R4Humans-AuxFiles/blob/master/MultiPlotFormatting/icd10cm_order_2018.csv%22">here</a></strong></p>
<pre class="r"><code>#### Packages ####
library(tidyverse)

#### Data Read In ####
diseases &lt;- read.csv(paste0(dir, &quot;icd10cm_order_2018.csv&quot;))

#### Data Split ####
infectious &lt;- diseases %&gt;%
  filter(str_detect(ICD10Code, &quot;(A|B)&quot;))  # Filtering to ICD10 codes for infectious diseases
cancer &lt;- diseases %&gt;%
  filter(str_detect(ICD10Code, &quot;^(C|D(1|2|3|4(0|1|2|3|4|5|6|7|8)))&quot;))  # Filtering to ICD10 codes for cancers

# Make random subset
set.seed(10212019)
infectious &lt;- remove_rownames(infectious[sample(1:nrow(infectious), 8), c(2, 4)])%&gt;%
  bind_cols(clinicA = sample(1:2000, 8),
            clinicB = sample(1:2000, 8))
cancer &lt;- remove_rownames(cancer[sample(1:nrow(cancer), 8), c(2, 4)])%&gt;%
  bind_cols(clinicA = sample(1:2000, 8),
            clinicB = sample(1:2000, 8))</code></pre>
</div>
<div id="basic-arrangement" class="section level1">
<h1>Basic Arrangement</h1>
<pre class="r"><code>#### Package ####
library(gridExtra)

#### Plotting ####
codesA &lt;- ggplot(cancer, aes(ICD10Code, clinicA)) +
  geom_col() +
  labs(x = &quot;ICD10 Code&quot;, y = &quot;Count&quot;, title = &quot;Clinic A&quot;) +
  coord_flip()  # Flip positions of x and y axis

codesB &lt;- ggplot(cancer, aes(ICD10Code, clinicB)) +
  geom_col() +
  labs(x = &quot;ICD10 Code&quot;, y = &quot;Count&quot;, title = &quot;Clinic B&quot;) +
  coord_flip()

#### Horizontal Orientation ####
grid.arrange(codesA, codesB, ncol=2)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#### Vertical Orientation ####
grid.arrange(codesA, codesB, nrow=2)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<div id="adding-text-arguments" class="section level2">
<h2>Adding text arguments</h2>
<p><code>grid.arrange</code> has arguments for adding text to the top, bottom, left, and right of the combined plot object.</p>
<pre class="r"><code>#### Basic Labelling ####
grid.arrange(codesA, codesB, ncol = 2, top = &quot;Cases of Selected Cancers&quot;,
             bottom = &quot;Note: Data is simulated&quot;, left = &quot;Left text if you need it&quot;,
             right = &quot;Right text if you need it&quot;)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Text labels can be further adjusted with <code>ggpubr::text_grob</code>.</p>
<pre class="r"><code>#### Adjusted Labelling ####
library(ggpubr)

grid.arrange(codesA, codesB, ncol = 2,
             top = text_grob(&quot;Cases of Selected Cancers&quot;, size = 16, face = &quot;bold&quot;),
             bottom = text_grob(&quot;Note: Data is simulated&quot;, size = 8, face = &quot;italic&quot;, hjust = -2))</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="alignment" class="section level1">
<h1>Alignment</h1>
<p>This is all good and wonderful until something like this happens (Yes those are the same graph, albeit in a different order, but I’m trying to prove a point). Oof. That’s a homely child.</p>
<pre class="r"><code>#### Plotting ####
desc &lt;- ggplot(infectious, aes(ShortDesc, clinicA))+
  geom_col()
descf &lt;- desc + coord_flip()
desc &lt;- desc + theme(axis.text.x = element_text(angle = 45, hjust = 1))  # turn x axis labels

code &lt;- ggplot(infectious, aes(ICD10Code, clinicA)) +
  geom_col()
codef &lt;- code + coord_flip()
code &lt;- code + theme(axis.text.x = element_text(angle = 45, hjust = 1))

#### Ugly Arrangements ####
grid.arrange(codef, descf, nrow = 2)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>grid.arrange(code, desc, ncol = 2)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>grid.arrange</code> doesn’t allow for easy alignment. For that, we need the <code>cowplot</code> package.</p>
<pre class="r"><code>library(cowplot)

#### Vertical Orientation ####
plot_grid(descf, codef, nrow = 2, align = &quot;v&quot;)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#### Horizontal Orientation ####
plot_grid(code, desc, ncol = 2, align = &quot;h&quot;)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>To be fair, this one is still pretty homely, but it’s an improvement.</p>
<div id="adding-text-arguments-1" class="section level2">
<h2>Adding text arguments</h2>
<p>Adding text labels to cowplots are not the easiest. It involved the nesting of cowplot arrangements. The <code>rel_heights</code> argument overrides some super questionable default spacing.</p>
<pre class="r"><code>plots &lt;- plot_grid(descf, codef, nrow = 2, align = &quot;v&quot;)
title &lt;- ggdraw() + draw_label(&quot;Cases of Selected Infectious Diseases&quot;)
plot_grid(title, plots, ncol = 1, rel_heights = c(.5, 11))</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="shared-legends" class="section level1">
<h1>Shared Legends</h1>
<p>If you have two graphs with the same legend, repeating it is often unsightly. One way to deal with this is to have one and print it on a side like so.</p>
<pre class="r"><code>can &lt;- cancer %&gt;%
  gather(clinic, count, 3:4) %&gt;%
  ggplot(aes(ICD10Code, count, fill = clinic)) +
    geom_col() +
    labs(x=&quot;ICD10 Codes&quot;, y=&quot;Count&quot;, fill=&quot;Clinic&quot;, title=&quot;Select Cancers&quot;) +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))

inf &lt;- infectious %&gt;%
  gather(clinic, count, 3:4) %&gt;%
  ggplot(aes(ICD10Code, count, fill = clinic)) +
    geom_col() +
  labs(x = &quot;ICD10 Codes&quot;, y = &quot;Count&quot;, fill = &quot;Clinic&quot;, title = &quot;Select Infectious Diseases&quot;) +
  theme(legend.position = &quot;none&quot;,
        axis.text.x = element_text(angle = 90, hjust = 1))

grid.arrange(inf, can, ncol = 2)</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The issue here is that each plot is given equal space within the combined plot. However, because the cancer plot has the legend, the actual plot area is smaller than the infectious disease plot. <code>gglot2</code> allows for moving the legend to the bottom but then it will be off-center. The answer is, yet again, another package.</p>
<pre class="r"><code>library(ggpubr)

inf &lt;- inf + theme(legend.position = &quot;right&quot;)  # adding back legend

(plots &lt;- ggarrange(inf, can, ncol = 2, common.legend = T, legend = &quot;bottom&quot;))</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="adding-text-arguments-2" class="section level2">
<h2>Adding text arguments</h2>
<pre class="r"><code>annotate_figure(plots, top = text_grob(&quot;Cases by Clinic and Disease Category&quot;,
                                    size = 16, face = &quot;bold&quot;))</code></pre>
<p><img src="/project/MultiPlotFormatting_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>

    
    

    

    

</main>

        <footer id = "bigfooter">
            <div style = "padding:15px;">
                <p>Powered by <a href="https://gohugo.io">Hugo</a>. Themed by <a href="https://github.com/nathancday/min_night">min_night</a>.
                </p>
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/"
                title="Creative Commons Attribution 4.0 International license">
                <i class="fab fa-creative-commons" aria-hidden="true"></i> Attribution 4.0 International license
                </a>
            </div>
        </footer>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id="></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());
          gtag('config', '');
        </script>
       
    </body>

</html>

